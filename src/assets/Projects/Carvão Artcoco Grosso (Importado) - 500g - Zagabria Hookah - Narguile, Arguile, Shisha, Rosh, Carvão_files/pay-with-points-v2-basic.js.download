var FMPWPSdk,FMPWPSdks={init:function(store,$){FMPWPSdk=this.settings;var tk=document.getElementById('tkwidgetloyaltytrade');if(tk!==undefined&&tk!==null){store=atob(tk.innerHTML);}
FMPWPSdks.settings.storeId=store;if(typeof jQuery==="undefined"){var count=0;var id=setInterval(function(){if(typeof jQuery!=="undefined"){FMPWPSdks.start(store);count=1000;}
count++;if(count>=1000){clearInterval(id);}},500);}else{FMPWPSdks.start(store);}},start:function(store){try{$=jQuery;}catch(e){}
if(store==null){return;}
jQuery(document).on('click','#btn-fmais-forma-points-code-copy-v2',function(e){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();try{var code=jQuery(this).data('code');var $temp=jQuery("<input>");jQuery("body").append($temp);$temp.val(code).select();document.execCommand("copy");$temp.remove();jQuery(this).html('Copiado!');setTimeout(function(){jQuery(this).html(code);},1500);}catch(e){}});jQuery(document).on('click','#btn-fmais-forma-points-description-v2',function(e){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();try{var document=jQuery('#fmpwp-document-app-checkout-v2').val();FMPWPSdks.applyMyPoints(document);}catch(e){}});jQuery(document).on('click','#btn-fmpwp-document-app-checkout-v2',function(e){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();try{var document=jQuery('#fmpwp-document-app-checkout-v2').val();if(FMPWPSdks.isDoocaCommerce()){document=window.dooca.customer.cgc;jQuery('#btn-fmpwp-document-app-checkout-v2').attr('disabled',true);jQuery('#btn-fmpwp-document-app-checkout-v2').addClass('disabled');jQuery('#btn-fmpwp-document-app-checkout-v2').html('Aguarde...');FMPWPSdks.applyMyPoints(document);}else if(jQuery(this).hasClass('fmpwp-document-filter-v2')){FMPWPSdks.applyMyPoints(document);}else{FMPWPSdks.searchMyDiscount(document);}}catch(e){}});if(FMPWPSdks.isLojaIntegrada()){try{var data=FMPWPSdks.getData();if(data===undefined||data.TextButton===undefined||typeof data.TextButton==="undefined"){var id=setInterval(function(){data=FMPWPSdks.getData();if(data!==undefined&&data.TextButton!==undefined&&typeof data.TextButton!=="undefined"){clearInterval(id);FMPWPSdks.addHTMLLI(store);}},500);}else{FMPWPSdks.addHTMLLI(store);}}catch(e){console.log('Error LI: '+e)}}
if(FMPWPSdks.isNuvemShop()){FMPWPSdks.addHTMLNuvem(store);}
if(FMPWPSdks.isDoocaCommerce()){var data=FMPWPSdks.getData();if(data!==undefined&&data!==null&&data.Active){var css='';if(FMPWPSdks.settings.isMobile){css='position: initial !important;width: 100% !important;'}
var html='<div class="row align-items-center position-relative mt-3" style="border: solid .1rem #e1e1e1;border-radius: 5px;padding-bottom: 13px;" id="fm-points-find-v2">';html+='	<div class="col-12 col-sm mt-3 mb-sm-0"> ';html+='		<label class="label mr-3 mb-0">Complete seu pagamento com seus <strong>pontos de fidelidade</strong></label> ';html+='	</div> ';html+='	<div class="col-12 col-sm-auto mt-3" style="">';html+='		<button class="btn btn-secondary" id="fm-btn-find-points-v2" style="'+css+'"> <span class="text">Consultar meu saldo</span> <span class="static-loader"></span> </button>';html+='	</div>';html+='</div>';try{if((typeof jQuery('.coupon-code').html()==='undefined')){if(document.getElementById('fm-points-find-v2')===null){jQuery('.form-coupon .row').after(html);}}else{console.log('já aplicado um cupom');}}catch(e){}}}
jQuery(document).on('click','#fm-btn-find-points-v2',function(e){e.preventDefault();var list=document.body.classList;var documentNumber=window.dooca.customer.cgc;jQuery.each(list,function(index,item){if(item==='page-checkout'&&typeof documentNumber!=='undefined'){jQuery('#fm-btn-find-points-v2').html('Aguarde...');jQuery('#fm-btn-find-points-v2').css('disabled',true);jQuery('#fm-btn-find-points-v2').addClass('disabled');FMPWPSdks.searchMyDiscount(documentNumber);}});});if(FMPWPSdks.iswBuy()){var data=FMPWPSdks.getData();if(data!==undefined&&data!==null&&data.Active){var html='<div id="fm-points-find-v2" style="display: block;">';html+='	<div class="border rounded border-secondary text-center text-secondary p-2" style="border-top: solid 1px #ddd;padding-top: 15px;padding-bottom: 5px;margin-top: 10px;">';html+='		<p class="" style="width: 100%;font-size: 16px;margin-bottom: 10px;">'+data.Message+'</p>';html+='		<div class="input-group mb-3">';html+='			<input type="text" max="18" maxlength="18" class="form-control mask-cpf" id="fmpwp-document-app-checkout-v2" placeholder="Digite seu CPF e/ou CNPJ" aria-label="Digite seu CPF e/ou CNPJ" aria-describedby="">';html+='			<div class="input-group-append">';html+='				<button id="fm-btn-find-points-v2-wbuy" class="btn btn-outline-secondary fmpwp-document-filter-v2" type="button">'+data.TextButton+'</button>';html+='			</div>';html+='		    <div class="alert alert-info mt-2 d-none" id="points-alert" role="alert"></div>';html+='		</div>';html+='	</div>';html+='</div>';if(document.getElementById('fm-points-find-v2')===null){jQuery('.itens .totais').before(html);}}}
jQuery(document).on('click','#fm-btn-find-points-v2-wbuy',function(e){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();var doc=jQuery('#fmpwp-document-app-checkout-v2').val();if(doc===''||doc===null||doc===undefined||typeof doc==='undefined'){jQuery('#points-alert').removeClass('alert-info').removeClass('alert-success').removeClass('alert-danger').addClass('alert-danger');jQuery('#points-alert').html('Informe o CPF e/ou CNPJ');jQuery('#points-alert').removeClass('d-none');return;}
jQuery('#points-alert').addClass('d-none');try{if(jQuery('#fm-btn-find-points-v2-wbuy').hasClass('fmpwp-document-filter-v2')){FMPWPSdks.searchMyDiscount(doc);}}catch(e){}});jQuery(document).on('click','#points-apply-cashback',function(e){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();jQuery('#fm-btn-find-points-v2-wbuy').removeClass('fmpwp-document-filter-v2');var doc=jQuery('#fmpwp-document-app-checkout-v2').val();FMPWPSdks.applyMyPoints(doc);});if(FMPWPSdks.isTrayCommerce()){}
if(FMPWPSdks.isTrayCorp()){var data=FMPWPSdks.getData();if(data!==undefined&&data!==null&&data.Active){var email=jQuery('#loginInput').val();if(email!==null&&email!==''&&typeof email!=='undefined'&&email!==undefined){email=Fbits.Carrinho.Usuario.Email;FMPWPSdks.searchMyDiscount(email,'email');}}}
if(FMPWPSdks.isWooCommerce()){}
if(FMPWPSdks.isJetCommerce()){}
if(FMPWPSdks.isVtex()){}
jQuery(document).on('keypress','.mask-cpf',function(){if(jQuery(this).val().length<=14){FMPWPSdk.mask(this,'cpf');}else{FMPWPSdk.mask(this,'cnpj');}});try{jQuery(document).on('keypress','input[name=cpf]',function(){FMPWPSdk.setDocument();});}catch(e){}},startDooca:function(){if(typeof jQuery('.coupon-code').html()==='undefined'){var list=document.body.classList;var documentNumber=window.dooca.customer.cgc;jQuery.each(list,function(index,item){if(item==='page-checkout'&&typeof documentNumber!=='undefined'){FMPWPSdks.searchMyDiscount(documentNumber);}});}else{console.log('já aplicado um cupom');}},addHTMLLI:function(store){var data=FMPWPSdks.getData();if(document.getElementsByClassName('pagina-carrinho').length>=1&&data!==undefined&&data!==null&&data.Active&&data.ShowOnSite){var html='<td colspan="7" class="bg-dark" id="fmpwp-document-app-checkout-v2-tr">';html+='    <div class="form-horizontal" id="fmais-forma-points" style="margin: 5px 0 0 0;">';html+='        <div class="control-group">';html+='            <label class="control-label" for="">';html+='                <b>Cashback:</b>';html+='            </label>';html+='            <div class="controls text-left">';html+='                <div class="input-append" style="text-align: left;">';html+='                    <input type="text" style="width: 54%;" name="cpf" placeholder="Digite seu CPF e/ou CNPJ" id="fmpwp-document-app-checkout-v2" max="18" maxlength="18" class="form-control input-small mask-cpf mask-cpf" value="">';html+='                    <button class="btn" type="button" id="btn-fmpwp-document-app-checkout-v2" style="border-radius: 0 4px 4px 0;background-color: '+data.Color+';background: '+data.Color+';color: '+data.TextColor+';">';html+='                        <i class="icon-gift"></i>'+data.TextButton;html+='                    </button>';html+='                   <input type="hidden" value="" id="fmpwp-document-app-checkout-v2-url" name="fmpwp-document-app-checkout-v2-url" />';html+='                </div>';html+='                <p class="text-left cor-principal changed alert alert-info" id="fmais-forma-points-description" style="margin-top: 3px;margin-bottom: 0px;padding: 10px;">* '+data.Message+'</p>';html+='            </div>';html+='        </div>';html+='    </div>';html+='</td>';if(document.getElementById('fmpwp-document-app-checkout-v2-tr')===null){var count=jQuery('table.tabela-carrinho tbody tr').length-1;jQuery('table.tabela-carrinho tbody tr').filter(':nth-child('+count+')').after(html);}}},addHTMLNuvem:function(store){var data=FMPWPSdks.getData();if(document.getElementsByClassName('summary').length>=1&&data!==undefined&&data!==null&&data.Active){var html='<div class="box-discount-coupon-applied" style="margin-bottom: 5px;border-radius: 10px !important;" id="fmpwp-document-app-checkout-v2-box">';html+='    <span>'+data.Message+'</span>';html+='    <div class="form-group form-group-error" style="margin-top: 5px !important;">';html+='        <div class="has-float-label">';html+='            <span id="btn-fmpwp-document-app-checkout-v2" name="btn-fmpwp-document-app-checkout-v2" class="form-control-help" style="cursor: pointer !important;background-color: '+data.Color+';background: '+data.Color+';border-radius: 3px;padding: 5px 10px;opacity: unset;">';html+='                <a class="translate-link" style="background-color: '+data.Color+';color: '+data.TextColor+';text-decoration: none;">'+data.TextButton+'</a>';html+='            </span>';html+='            <input id="fmpwp-document-app-checkout-v2" name="fmpwp-document-app-checkout-v2" max="18" maxlength="18" style="border-radius: 3px 3px 0 0;" class="form-control mask-cpf" type="tel" test-id="fmpwp-document-app-checkout-v2" placeholder=" " autocomplete="fmpwp-document-app-checkout-v2" value=""><label class="input-label" for="fmpwp-document-app-checkout-v2">Digite seu CPF e/ou CNPJ</label>';html+='        </div>';html+='        <div class="error" id="fmpwp-document-app-checkout-v2-error"></div>';html+='    </div>';html+='</div>';if(document.getElementById('couponForm')!==null){html='<div class="" id="fmpwp-document-app-checkout-v2-box" style="display: nonebackground: #fafafa;padding: 10px 15px;margin-bottom: 10px;">';html+='    <span>Complete o pagamento com seus pontos de fidelidade!</span>';html+='    <div class="">';html+='        <div id="" class="">';html+='            <div class="">';html+='                <input id="fmpwp-document-app-checkout-v2" name="fmpwp-document-app-checkout-v2" max="18" maxlength="18" style="border-radius: 3px 3px 0 0;" class="form-control mask-cpf" type="tel" placeholder="Digite seu CPF e/ou CNPJ" autocomplete="fmpwp-document-app-checkout-v2" value="">';html+='                <button class="btn btn-block" name="btn-fmpwp-document-app-checkout-v2" id="btn-fmpwp-document-app-checkout-v2" style="padding: 5px 18px;background-color: '+data.Color+';color: '+data.TextColor+';border-radius: 0px;">';html+='                    Eu quero';html+='                </button>';html+='            </div>';html+='        </div>';html+='    </div>';html+='    <div class="error" id="fmpwp-document-app-checkout-error" style="margin-top: 5px;"></div>';html+='</div>';}
if(document.getElementById('fmpwp-document-app-checkout-v2-box')===null){if(document.getElementById('couponForm')===null){if(FMPWPSdk.isMobile){jQuery('.summary-coupon:eq(0) .box-discount-coupon-applied').before(html);}else{jQuery('.summary-details .summary-coupon').prepend(html);}}else{if(FMPWPSdk.isMobile){jQuery('.main-view .mobile-coupon-container').after(html);}else{jQuery('#total-box .total-table').after(html);}}}}},addHTMLDooca:function(json){var data=FMPWPSdks.getData();if(json.message!==null&&json.message!==undefined&&typeof json.message!=='undefined'){if(document.getElementById('fmpwp-document-app-checkout-v2-box')===null){jQuery('.payment-list .payment-discount').after('<div class="alert alert-info mt-3">'+json.message+'</div>');}
jQuery('#fm-points-find-v2').css('display','none');}
else if(data!==undefined&&data!==null&&data.Active&&json!==null&&json!==undefined&&json!==''&&json.data!==undefined&&json.data.cashBalanceAvailable!==undefined){if(json.data.cashBalanceAvailable>0){var html='<div class="payment-discount " id="fmpwp-document-app-checkout-v2-box">                                                                                ';html+='	<div class="block block-collapse is-open">                                                                                            				';html+='		<div class="block-header">                                                                                                        				';html+='			<div class="block-col text-center text-sm-left">                                                                              				';html+='				<i class="icon d-none d-sm-block icon fm-ic-money"></i>                                                                   				';html+='				<span class="title title--sm text-center text-sm-left">'+data.Message+'</span>         				';html+='			</div>                                                                                                                        				';html+='		</div>                                                                                                                            				';html+='		<div class="block-content">                                                                                                       				';html+='			<form class="form form-coupon-points" method="get" action="">                                                                 				';html+='				<div class="row align-items-center position-relative">                                                                    				';html+='					<div class="d-none d-sm-block col-12 col-sm-auto">                                                                    				';html+='						<label class="label mr-3 mb-0">Saldo disponível</label>                                                           				';html+='					</div>                                                                                                                				';html+='					<div class="col-12 col-sm mb-3 mb-sm-0">                                                                              				';html+='						<input type="text" class="form-control" name="points" value="R$ '+json.data.cashBalanceAvailable.toFixed(2).replace('.',',')+'" placeholder="Saldo disponível" readonly="">				';html+='						<input data-price="'+json.data.cashBalanceAvailable+'" data-points="'+json.data.pointsNeeded+'" type="hidden" id="fmpwp-document-app-checkout-v2" name="fmpwp-document-app-checkout-v2" />				';html+='					</div>                                                                                                                				';html+='					<div class="col-12 col-sm-auto">                                                                                      				';html+='						<button type="button" name="btn-fmpwp-document-app-checkout-v2" id="btn-fmpwp-document-app-checkout-v2" class="btn btn-secondary">    ';html+='							<span class="text">'+data.TextButton+'</span>                                                                             				';html+='							<span class="static-loader"></span>                                                                           				';html+='						</button>                                                                                                         				';html+='					</div>                                                                                                                				';html+='				</div>                                                                                                                    				';html+='				<div class="row align-items-center position-relative">                                                                    				';html+='                   <div class="col-12 col-sm-auto mt-3">';html+='                       <label class="d-none d-sm-block label mr-3 mb-0 text-danger" style="font-size: 13px;font-style: italic;"> Não é permitido o uso de mais de um cupom por compra.</label>';html+='                   </div>';html+='				</div>                                                                                                                    				';html+='			</form>                                                                                                                       				';html+='		</div>                                                                                                                            				';html+='	</div>                                                                                                                                				';html+='</div>																																	  				';if(document.getElementById('fmpwp-document-app-checkout-v2-box')===null){jQuery('.payment-list .payment-discount').after(html);jQuery('#fm-points-find-v2').css('display','none');if(FMPWPSdks.settings.isMobile){jQuery('#btn-fmpwp-document-app-checkout-v2').addClass('btn-block');}}}else{if(document.getElementById('fmpwp-document-app-checkout-v2-box')===null){jQuery('.payment-list .payment-discount').after('<div class="alert alert-info mt-3">Olá, obrigado por nos consultar! Você ainda não tem saldo suficiente para efetuar um resgate, continue comprando e acumule para a próxima compra ;)</div>');}
jQuery('#fm-points-find-v2').css('display','none');}}},applyMyPoints:function(document){var data=FMPWPSdks.getData();if(document===''||document===undefined||document===null||document===' '){FMPWPSdks.alert('d','Digite seu CPF e/ou CNPJ');return;}
FMPWPSdks.disabled(true,'Aguarde...','btn-fmais-forma-points-description-v2');FMPWPSdks.disabled(true,'Aguarde...');var partner=0;var partnerGroupId='';if(FMPWPSdks.isLojaIntegrada()){partner=FMPWPSdks.partnerEnum.LojaIntegrada;partnerGroupId=FMPWPSdks.partners.LojaIntegradaId;}
if(FMPWPSdks.isNuvemShop()){partner=FMPWPSdks.partnerEnum.NuvemShop;partnerGroupId=FMPWPSdks.partners.NuvemShopId;}
if(FMPWPSdks.isDoocaCommerce()){partner=FMPWPSdks.partnerEnum.Dooca;partnerGroupId=FMPWPSdks.partners.DoocaCommerceId;}
if(FMPWPSdks.iswBuy()){partner=FMPWPSdks.partnerEnum.WBuy;partnerGroupId=FMPWPSdks.partners.wBuyId;}
if(FMPWPSdks.isTrayCorp()){partner=FMPWPSdks.partnerEnum.TrayCorp;partnerGroupId=FMPWPSdks.partners.TrayCorpId;}
var model={AccountManager:document,StoreId:FMPWPSdks.settings.storeId,Document:document,Partner:partner,Cashback:true,Points:jQuery('#fmpwp-document-app-checkout-v2').data('points'),RealValue:jQuery('#fmpwp-document-app-checkout-v2').data('price'),PartnerGroupId:partnerGroupId,ShopForSale:FMPWPSdk.shopForSale,ShortDescription:'CASHBACK',ValidMember:true,WithReturn:true,};var text=jQuery('#points-apply-cashback').html();jQuery('#points-apply-cashback').html('Aguarde...');FMPWPSdks.settings.post(FMPWPSdks.settings.getQueryAddCoupon(),model).onreadystatechange=(function(){if(FMPWPSdks.settings.completed(this)){var json=JSON.parse(this.responseText);if(FMPWPSdks.isLojaIntegrada()){FMPWPSdks.resultLI(json,data);}
if(FMPWPSdks.isNuvemShop()){FMPWPSdks.resultNuvem(json,data);}
if(FMPWPSdks.isDoocaCommerce()){jQuery('input[name=coupon]').val(json.data.couponCode);jQuery('.form-coupon').submit();}
if(FMPWPSdks.iswBuy()){jQuery('input[name=cupom]').val(json.data.couponCode);jQuery('#aplicar-cupom').trigger('click');}
if(FMPWPSdks.isTrayCorp()&&json.success){jQuery('#points-alert').html('Parabéns, seu resgate foi concluído com sucesso. Aguarde, estamos atualizando o saldo em sua conta corrente. Vamos atualizar a página, depois verifique em sua conta corrente.');jQuery('#points-apply-cashback').hide();setTimeout(function(){location.reload();},6000);}else if(FMPWPSdks.isTrayCorp()){jQuery('#points-alert').html(json.mensagem);jQuery('#points-apply-cashback').hide();}}});},resultNuvem:function(json,data){try{if(json!==null&&json!==undefined&&json!==''&&json.data!==undefined&&json.data.couponCode!==undefined){if(json.data.couponCode!==''){FMPWPSdks.setDiscountOK(true);var url=jQuery('#fmpwp-document-app-checkout-v2-url').val();var message='Seu resgate foi concluido com sucesso!<br />Seu cupom de desconto é este: <strong style="font-weight: bold;color: #878484;padding: 3px 5px;border-radius: 5px;background: #fff;cursor: pointer;" id="btn-fmais-forma-points-code-copy-v2" data-code="'+json.data.couponCode+'">'+json.data.couponCode+'</strong>, copie o código, cole no campo desconto e aplique em sua compra.';FMPWPSdks.alert('s',message);}else{FMPWPSdks.alert('i','Desculpe, ocorreu algum erro, tente novamente ou entre em contato com nosso suporte.');}}else{FMPWPSdks.alert('i',json.message);}
jQuery('#btn-fmpwp-document-app-checkout-v2').removeClass('fmpwp-document-filter-v2');FMPWPSdks.disabled(false,data.buttonText);}catch(e){jQuery('#btn-fmpwp-document-app-checkout-v2').removeClass('fmpwp-document-filter-v2');FMPWPSdks.disabled(false,data.buttonText);console.log('Error: '+e);}},resultLI:function(json,data){try{if(json!==null&&json!==undefined&&json!==''&&json.data!==undefined&&json.data.couponCode!==undefined){if(json.data.couponCode!==''&&json.data.couponCode!==undefined){$('#btn-fmpwp-document-app-checkout-v2').addClass('fmpwp-document-filter-v2');var message='Seu resgate foi concluido com sucesso!<br />Aguarde, estamos aplicando seu desconto.<br />';FMPWPSdks.setDiscountOK(true);var url=jQuery('#fmpwp-document-app-checkout-v2-url').val();FMPWPSdks.alert('s',message);setTimeout(function(){window.open(url+json.data.couponCode+'&utm_source=fidelizar-checkout&utm_medium=pontos-mais-dinheiro&utm_campaign=fidelizar-mais&utm_term=fidelizar-mais&utm_content=programa-fidelidade','_self');},1500);}else{FMPWPSdks.disabled(false,'<i class="icon-gift"></i>'+data.TextButton);FMPWPSdks.alert('i','Ainda não foi desta vez. Conclua sua compra e resgate na próxima :)');}}else{FMPWPSdks.disabled(false,'<i class="icon-gift"></i>'+data.TextButton);FMPWPSdks.alert('i',json.message);}}catch(e){jQuery('#btn-fmpwp-document-app-checkout-v2').removeClass('fmpwp-document-filter-v2');FMPWPSdks.disabled(false,'<i class="icon-gift"></i>'+data.TextButton);console.log('Error: '+e);}},searchMyDiscount:function(doc,byEmail){var data=FMPWPSdks.getData();if(doc===''||doc===undefined||doc===null||doc===' '){FMPWPSdks.alert('d','Digite seu CPF e/ou CNPJ');return;}
FMPWPSdks.disabled(true,'Aguarde...');var url=FMPWPSdks.settings.getQueryCoupon(doc,byEmail,true);FMPWPSdks.settings.get(url).onreadystatechange=(function(){if(FMPWPSdks.settings.completed(this)){var json=JSON.parse(this.responseText);if(FMPWPSdks.isLojaIntegrada()){FMPWPSdks.resultLIDiscount(json,data);}
if(FMPWPSdks.isNuvemShop()){FMPWPSdks.resultNuvemDiscount(json,data);}
if(FMPWPSdks.isDoocaCommerce()){FMPWPSdks.addHTMLDooca(json);}
if(FMPWPSdks.iswBuy()){if(json.success&&json.statusCode===200&&typeof json.data!=='undefined'&&json.data.pointsNeeded>0&&json.data.cashBalanceAvailable!==undefined&&typeof json.data.cashBalanceAvailable!=='undefined'){jQuery('#points-alert').removeClass('alert-info').removeClass('alert-success').removeClass('alert-danger').addClass('alert-success');jQuery('#points-alert').html('Seu saldo disponível para uso é de: <strong>R$ '+json.data.cashBalanceAvailable.toFixed(2).replace('.',',')+'</strong><br /><span id="points-apply-cashback" style="cursor: pointer;font-weight: bold;border-bottom: 1px dotted;border-radius: 3px;padding: 3px 5px;background: #fff;">Clique aqui para aplicar seu CASHBACK</span>');jQuery('#fmpwp-document-app-checkout-v2').attr('data-price',json.data.cashBalanceAvailable);jQuery('#fmpwp-document-app-checkout-v2').attr('data-points',json.data.pointsNeeded);jQuery('#points-alert').removeClass('d-none');}else{jQuery('#points-alert').removeClass('alert-info').removeClass('alert-success').removeClass('alert-danger').addClass('alert-info');jQuery('#points-alert').html('Obrigado por nos consultar! Você ainda não tem saldo suficiente para efetuar um resgate, continue comprando e acumule para a próxima compra ;)');jQuery('#points-alert').removeClass('d-none');}}
if(FMPWPSdks.isTrayCorp()&&json.data!==undefined&&json.data.cashBalanceAvailable!==undefined){var mensagem='Seu saldo disponível para uso é de: <strong>R$ '+json.data.cashBalanceAvailable.toFixed(2).replace('.',',')+'</strong>';var html='<div class="box-default" id="fm-points-find-v2">';html+='    <h5 class="title-box"><i class="fa fa-money" aria-hidden="true"></i> '+data.Message+'</h5>';html+='    <div class="alert-div-info" id="fbits-cupom-body" style="margin-bottom: 5px;display: block;">';html+='       <span class="checkout-mensagem-passo-info envio-info" id="points-alert">'+mensagem+'</span>';html+='       <input type="hidden" data-points="'+json.data.pointsNeeded+'" data-price="'+json.data.cashBalanceAvailable+'" value="'+json.data.member.document+'" id="fmpwp-document-app-checkout" name="fmpwp-document-app-checkout" />';html+='    </div>';html+='	<a style="max-width: initial;" href="#" class="btn btn-info btn-block" data-document="'+json.data.member.document+'" id="points-apply-cashback">Clique aqui para aplicar seu CASHBACK</button>';html+='</div>';if(document.getElementById('fm-points-find-v2')===null){jQuery('#div-cupom').after(html);}}}else if(FMPWPSdks.settings.error(this)){console.log('error');}});},resultLIDiscount:function(json,data){try{if(json!==null&&json!==undefined&&json!==''&&json.data!==undefined&&json.data.cashBalanceAvailable!==undefined){if(json.data.cashBalanceAvailable>0){jQuery('#btn-fmpwp-document-app-checkout-v2').addClass('fmpwp-document-filter-v2');jQuery('#fmpwp-document-app-checkout-v2').attr('data-price',json.data.cashBalanceAvailable);jQuery('#fmpwp-document-app-checkout-v2').attr('data-points',json.data.pointsNeeded);var message='Ebaa, você tem <strong>R$ '+json.data.cashBalanceAvailable.toFixed(2).replace('.',',')+'</strong> disponível para resgate! <br />';message+='Clique em <code style="cursor: pointer;" id="btn-fmais-forma-points-description-v2"><strong><i class="icon-gift"></i>Aplicar desconto</strong></code> e receba seu desconto!';jQuery('#fmpwp-document-app-checkout-v2-url').val(location.origin+'/carrinho/cupom/validar?cupom=');FMPWPSdks.disabled(false,'<i class="icon-gift"></i>Aplicar desconto');FMPWPSdks.alert('s',message);}else{FMPWPSdks.disabled(false,'<i class="icon-gift"></i>'+data.TextButton);FMPWPSdks.alert('i','Ainda não foi desta vez. Conclua sua compra e resgate na próxima :)');}}else{FMPWPSdks.disabled(false,'<i class="icon-gift"></i>'+data.TextButton);FMPWPSdks.alert('i',json.message);}}catch(e){console.log('Error: '+e);}},resultNuvemDiscount:function(json,data){try{if(json!==null&&json!==undefined&&json!==''&&json.data!==undefined&&json.data.cashBalanceAvailable!==undefined){if(json.data.cashBalanceAvailable>0){jQuery('#btn-fmpwp-document-app-checkout-v2').addClass('fmpwp-document-filter-v2');jQuery('#fmpwp-document-app-checkout-v2').attr('data-price',json.data.cashBalanceAvailable);jQuery('#fmpwp-document-app-checkout-v2').attr('data-points',json.data.pointsNeeded);var message='Ebaa, você tem <strong style="font-weight: bold;color: #878484;padding: 3px 5px;border-radius: 5px;background: #fff;">R$ '+json.data.cashBalanceAvailable.toFixed(2).replace('.',',')+'</strong> disponível para resgate! <br />';message+='Clique em <strong style="line-height: 2.5em;font-weight: bold;color: #878484;padding: 3px 5px;border-radius: 5px;background: #fff;cursor: pointer;" id="btn-fmais-forma-points-description-v2">Aplicar</strong> e receba seu desconto!';FMPWPSdks.alert('s',message);}else{FMPWPSdks.alert('i','Ainda não foi desta vez. Conclua sua compra e resgate na próxima :)');}
FMPWPSdks.disabled(false,data.TextButton);}else{FMPWPSdks.disabled(false,data.TextButton);FMPWPSdks.alert('i',json.message);}}catch(e){console.log('Error: '+e);}},getPartnerId:function(){var partner=document.getElementById('tkwidgetloyaltytradepartnter');if(partner!==null&&partner!==undefined){return atob(partner.innerHTML);}
else{return null;}},partnerEnum:{Fidelizar:0,LojaIntegrada:1,Xtech:2,WBuy:3,Bling:4,Vhsys:5,Omie:6,WooCommerce:7,Tiny:8,NuvemShop:9,Magento:10,JetNeo:11,Tray:12,Dooca:13,Eccosys:14,TrayCorp:15,Xtech1:16,BwCenter:17,Betalabs:18},partners:{wBuyId:'4835ea58-e310-4b3f-aa58-b124125b063d',LojaIntegradaId:'6f0f0d3a-6b1c-4896-af28-f6d7aeb4312f',NuvemShopId:'42b45633-ff1a-43e4-9be7-9732ae743bdd',TrayCommerceId:'a7401bee-a5e2-46c2-8ec3-3e30babe1736',TrayCorpId:'ccf300cd-de89-41c5-a4da-a2b54a7bd219',WooCommerceId:'edbbe05a-5355-45d0-b209-41c2a37b0f47',DoocaCommerceId:'f39c818d-c416-4f54-a044-7fedcbbd8ce9',JetCommerceId:'ba429e50-07de-447a-a7e9-f6d5bd54bcc9',VtexId:'584d87d3-f909-4382-8381-1ca2a49ff67c',},alert:function(type,message){if(FMPWPSdks.isLojaIntegrada()){if(type==='i'){jQuery('#fmais-forma-points-description').removeClass('alert-warning').removeClass('alert-success').removeClass('alert-danger').addClass('alert-info');}
if(type==='w'){jQuery('#fmais-forma-points-description').removeClass('alert-info').removeClass('alert-success').removeClass('alert-danger').addClass('alert-warning');}
if(type==='d'){jQuery('#fmais-forma-points-description').removeClass('alert-info').removeClass('alert-success').removeClass('alert-warning').addClass('alert-danger');}
if(type==='s'){jQuery('#fmais-forma-points-description').removeClass('alert-info').removeClass('alert-warning').removeClass('alert-danger').addClass('alert-success');}
jQuery('#fmais-forma-points-description').html(message);}
if(FMPWPSdks.isNuvemShop()){if(type==='i'){jQuery('#fmpwp-document-app-checkout-v2-error').html('<div class="alert required alert-danger-bagged" style="display: inline-block;line-height: 1.9em;text-align: left;background: #00BCD4;color: #fff;">'+message+'</div>');}
if(type==='d'){jQuery('#fmpwp-document-app-checkout-v2-error').html('<div class="alert required alert-danger-bagged" style="display: inline-block;line-height: 1.9em;background: #ef5350;color: #fff;">'+message+'</div>');}
if(type==='w'){jQuery('#fmpwp-document-app-checkout-v2-error').html('<div class="alert required alert-danger-bagged" style="display: inline-block;line-height: 1.9em;background: #FFC107;color: #fff;">'+message+'</div>');}
if(type==='s'){jQuery('#fmpwp-document-app-checkout-v2-error').html('<div class="alert required alert-danger-bagged" style="display: inline-block;line-height: 1.9em;background: #8BC34A;color: #fff;">'+message+'</div>');}}},disabled:function(disabled,text,id){if(FMPWPSdks.isLojaIntegrada()){if(id===null||id===undefined){id='btn-fmpwp-document-app-checkout-v2';}
jQuery('#'+id).prop('disabled',disabled);jQuery('#'+id).html(text);}
if(FMPWPSdks.isNuvemShop()){if(id===null||id===undefined){id='btn-fmpwp-document-app-checkout-v2';}
jQuery('#'+id).prop('disabled',disabled);jQuery('#'+id).html(text);}
if(FMPWPSdks.iswBuy()){if(id===null||id===undefined){id='fm-btn-find-points-v2-wbuy';}
jQuery('#'+id).prop('disabled',disabled);jQuery('#'+id).html(text);}},setDiscountOK:function(eval){FMPWPSdks.settings.setStorage(FMPWPSdk.keys.discountOk,eval);},discountOk:function(){var data=FMPWPSdks.settings.getStorage(FMPWPSdk.keys.discountOk);return(data===null||data===undefined)?false:data;},setData:function(store){if(store===undefined||store===null||store===''||typeof store==='undefined'){return;}
var version='1.0.0';FMPWPSdks.settings.getCdn(FMPWPSdks.settings.cdn('files/production/'+store+'/settings/pay-with-points.json?ver='+version)).onreadystatechange=(function(){if(FMPWPSdks.settings.completed(this)){try{var json=JSON.parse(this.responseText);if(json!==null&&json!==undefined&&json!==''){FMPWPSdks.settings.setStorage(FMPWPSdk.keys.settings,json);}else{FMPWPSdks.settings.setStorage(FMPWPSdk.keys.settings,{});}}catch(e){FMPWPSdks.settings.setStorage(FMPWPSdk.keys.settings,{});console.log('Error: '+e);}}});},getData:function(){var data=document.getElementById('jsonwidgettradepay');if(data!==null&&data!==''&&data!==undefined&&typeof data!=='undefined'){data=JSON.parse(data.innerHTML);}
return(data===null||data===undefined)?{}:data;},iswBuy:function(){return(FMPWPSdks.getPartnerId()===FMPWPSdks.partners.wBuyId);},isLojaIntegrada:function(){return(FMPWPSdks.getPartnerId()===FMPWPSdks.partners.LojaIntegradaId);},isNuvemShop:function(){return(FMPWPSdks.getPartnerId()===FMPWPSdks.partners.NuvemShopId);},isTrayCommerce:function(){return(FMPWPSdks.getPartnerId()===FMPWPSdks.partners.TrayCommerceId);},isWooCommerce:function(){return(FMPWPSdks.getPartnerId()===FMPWPSdks.partners.WooCommerceId);},isDoocaCommerce:function(){return(FMPWPSdks.getPartnerId()===FMPWPSdks.partners.DoocaCommerceId);},isJetCommerce:function(){return(FMPWPSdks.getPartnerId()===FMPWPSdks.partners.JetCommerceId);},isVtex:function(){return(FMPWPSdks.getPartnerId()===FMPWPSdks.partners.VtexId);},isTrayCorp:function(){return(FMPWPSdks.getPartnerId()===FMPWPSdks.partners.TrayCorpId);},setDocument:function(){var dc='';try{try{if((document.getElementsByName('cpf')!==null)&&(dc===undefined||dc===''||dc===null)){try{dc=document.getElementsByName('cpf')[0].value;}catch(e){console.log('Error: '+e);}}}catch(e){}
try{if((document.getElementsByName('@billing_id_number')!==null)&&(dc===undefined||dc===''||dc===null)){try{dc=document.getElementsByName('@billing_id_number')[0].value;}catch(e){console.log('Error: '+e);}}}catch(e){}
try{if((document.getElementsByName('billing[cpf]')!==null)&&(dc===undefined||dc===''||dc===null)){try{dc=document.getElementsByName('billing[cpf]')[0].value;}catch(e){console.log('Error: '+e);}}}catch(e){}
try{if((document.getElementsByName('taxvat')!==null)&&(dc===undefined||dc===''||dc===null)){try{dc=document.getElementsByName('taxvat')[0].value;}catch(e){console.log('Error: '+e);}}}catch(e){}
try{if((document.getElementsByName('billing_cpf')!==null)&&(dc===undefined||dc===''||dc===null)){try{dc=document.getElementsByName('billing_cpf')[0].value;}catch(e){console.log('Error: '+e);}}}catch(e){}
try{if((document.getElementsByName('cpfu')!==null)&&(dc===undefined||dc===''||dc===null)){try{dc=document.getElementsByName('cpfu')[0].value;}catch(e){console.log('Error: '+e);}}}catch(e){}
FMPWPSdk.setStorage(FMPWPSdk.keys.document,dc,43200);}catch(e){}
try{dc=(dc!==null&&dc!==''&&dc!==undefined&&dc!==' '&&typeof dc!=='undefined')?document:((FMPWPSdk.getStorage(FMPWPSdk.keys.document)===false||FMPWPSgetStorage(FMPWPSdk.keys.document)===undefined||FMPWPSdk.getStorage(FMPWPSdk.keys.document)==='[object Object]')?null:FMPWPSdk.getStorage(FMPWPSdk.keys.document));FMPWPSdk.document=dc;}catch(e){}},settings:{cdn:function(query){return FMPWPSdks.settings.protocol+'://'+FMPWPSdks.settings.path.split(',')[0]+'.'+FMPWPSdks.settings.hostname+'/'+query;},getQueryCoupon:function(document,type,cashback){cashback=(typeof cashback==='undefined'||cashback===undefined)?false:true;var url='protected/motor-of-points/check-balance?storeId='+FMPWPSdks.settings.storeId+'&document='+document+'&cashback='+cashback;if(type!==undefined&&type!==null&&type!==''){url+='&byEmail='+type;}
return url;},getQueryAddCoupon:function(){return 'protected/motor-of-points/partner-redemption';},hostname:'fidelizarmais.com',path:'cdn',protocol:'https',keys:{document:'fmpwp-document-app',store:'fmpwp-store-id-app',action:'fmpwp-action-click-app',settings:'fmpwp-settings-app',discountOk:'fmpwp-discount-add'},baseUrl:function(){var host=window.location.hostname;switch(host){case "localhost":return 'http://localhost:52961/api/v2/public/';case "dev.dotcosmeticos.com.br":return 'https://sandbox-api.fidelizarmais.com/api/v1/';case "homolog.fidelizarmais.com":return 'https://sandbox.fidelizarmais.com/api/v2/public/';case "fidelizarmais.com":return 'https://sandbox-api.fidelizarmais.com/api/v1/';case "fmais.xtechcommerce.com":return 'https://sandbox-api.fidelizarmais.com/api/v1/';case "app.lojaintegrada.com.br":return 'https://sandbox-api.fidelizarmais.com/api/v1/';default:return 'https://gateway.fidelizarmais.com/api/v1/';}},secretKey:'YjM4NjY0ZjctNzUwMS00MDY3LWFkN2EtYjFkODQzYWEwYzg3',storeId:'',document:'',shopForSale:4,mask:function(obj,type){switch(type){case 'tel':{obj.value=FMPWPSdk.mtel(obj.value);return;}
case 'zip':{obj.value=FMPWPSdk.mzip(obj.value);return;}
case 'cpf':{obj.value=FMPWPSdk.mcpf(obj.value);return;}
case 'cnpj':{obj.value=FMPWPSdk.mcnpj(obj.value);return;}
case 'date':{obj.value=FMPWPSdk.mdate(obj.value);return;}
case 'hour':{obj.value=FMPWPSdk.mhour(obj.value);return;}
case 'domain':{obj.value=FMPWPSdk.mdomain(obj.value);return;}
case 'money':{obj.value=FMPWPSdk.mmoney(obj.value);return;}}},mtel:function(obj){obj=obj.replace(/\D/g,"")
obj=obj.replace(/^(\d)/,"($1")
obj=obj.replace(/(.{3})(\d)/,"$1)$2")
if(obj.length==9){obj=obj.replace(/(.{1})$/,"-$1")}else if(obj.length==10){obj=obj.replace(/(.{2})$/,"-$1")}else if(obj.length==11){obj=obj.replace(/(.{3})$/,"-$1")}else if(obj.length==12){obj=obj.replace(/(.{4})$/,"-$1")}else if(obj.length>12){obj=obj.replace(/(.{4})$/,"-$1")}
return obj;},mcnpj:function(obj){obj=obj.replace(/\D/g,"")
obj=obj.replace(/^(\d{2})(\d)/,"$1.$2")
obj=obj.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3")
obj=obj.replace(/\.(\d{3})(\d)/,".$1/$2")
obj=obj.replace(/(\d{4})(\d)/,"$1-$2")
return obj},mcpf:function(obj){obj=obj.replace(/\D/g,"")
obj=obj.replace(/(\d{3})(\d)/,"$1.$2")
obj=obj.replace(/(\d{3})(\d)/,"$1.$2")
obj=obj.replace(/(\d{3})(\d{1,2})$/,"$1-$2")
return obj},mzip:function(obj){obj=obj.replace(/\D/g,"")
obj=obj.replace(/^(\d{2})(\d)/,"$1.$2")
obj=obj.replace(/\.(\d{3})(\d)/,".$1-$2")
return obj},mdate:function(obj){obj=obj.replace(/\D/g,"")
obj=obj.replace(/(\d{2})(\d)/,"$1/$2")
obj=obj.replace(/(\d{2})(\d)/,"$1/$2")
return obj;},mhour:function(obj){obj=obj.replace(/\D/g,"")
obj=obj.replace(/(\d{2})(\d)/,"$1:$2")
return obj;},mdomain:function(obj){obj=obj.replace(/^https:\/\/?/,"")
domain=obj
path=""
if(obj.indexOf("/")>-1)domain=obj.split("/")[0]
path=obj.replace(/[^\/]*/,"")
domain=domain.replace(/[^\w\.\+-:@]/g,"")
path=path.replace(/[^\w\d\+-@:\?&=%\(\)\.]/g,"")
path=path.replace(/([\?&])=/,"$1")
if(path!="")domain=domain.replace(/\.+$/,"")
obj="https://"+domain+path
return obj;},mmoney:function(obj){obj=obj.replace(/\D/g,"")
obj=obj.replace(/(\d{1})(\d{14})$/,"$1.$2")
obj=obj.replace(/(\d{1})(\d{11})$/,"$1.$2")
obj=obj.replace(/(\d{1})(\d{8})$/,"$1.$2")
obj=obj.replace(/(\d{1})(\d{5})$/,"$1.$2")
obj=obj.replace(/(\d{1})(\d{1,2})$/,"$1,$2")
return obj;},setCookie:function(key,value,min){min=1;var d=new Date();d.setTime(d.getTime()+((min*3600)*1000));var expires="expires="+d.toUTCString();document.cookie=key+"="+value+";"+expires+";path=/";},setStorage:function(key,value,min){min=1;var expires=((new Date().getTime()+(min*3600))*1000);localStorage.setItem(key,JSON.stringify({"value":value,"expires":expires}));},removeCookie:function(key){var d=new Date();d.setTime(d.getTime()-(1000*60*60*24));var expires="expires="+d.toGMTString();window.document.cookie=key+"="+"; "+expires;},getCookie:function(key){var name=key+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1);}
if(c.indexOf(name)==0){return c.substring(name.length,c.length);}}
return false;},getStorage:function(key){FMPWPSdk.checkStorageExpires();var itemValue=localStorage[key];if(itemValue&&/^\{(.*?)\}$/.test(itemValue)){var current=JSON.parse(itemValue);return current.value;}
return false;},checkCookie:function(key){var obj=FMPWPSs.getCookie(key);if(obj!=""&&obj!=false){return true;}else{return false;}},checkStorage:function(key){FMPWPSdk.checkStorageExpires(key);var itemValue=localStorage[key];if(itemValue&&/^\{(.*?)\}$/.test(itemValue)){var current=JSON.parse(itemValue);return current.value;}
return false;},checkStorageExpires:function(key){var toRemove=[],currentDate=new Date().getTime();for(var i=0,j=localStorage.length;i<j;i++){var current=localStorage.getItem(localStorage.key(i));if(current&&/^\{(.*?)\}$/.test(current)){current=JSON.parse(current);if(current.expires&&current.expires<=currentDate){toRemove.push(key);}}}
for(var i=toRemove.length-1;i>=0;i--){localStorage.removeItem(toRemove[i]);}},removeStorage:function(key){localStorage.removeItem(key);},isPartnerOk:function(value){try{if(value!==null&&value!==''&&value!==' '&&typeof value!=='undefined'&&value!==undefined&&value.length>0){return true;}
return false;}catch(e){return false;}},isMobile:(navigator.userAgent.indexOf("Mobile")>0),language:((navigator.language==undefined)&&(navigator.userLanguage!=undefined))?navigator.userLanguage:((navigator.userLanguage==undefined||navigator.userLanguage==''||navigator.userLanguage==null||navigator.userLanguage==' '||navigator.userLanguage=='undefined')?'pt-BR':language),completed:function(request){return(request.readyState===4&&request.status===200);},error:function(request){return(request.readyState===4&&request.status!==200);},XMLHttpRequest:(typeof XMLHttpRequest!=='undefined')?new XMLHttpRequest():new ActiveXObject('Microsoft.XMLHTTP'),send:function(request,type,query,data){var urlApi=FMPWPSdks.settings.baseUrl();urlApi+=(query!==undefined&&query!=='undefined'&&query!=='')?query:'';request.open(type,urlApi,true);request.overrideMimeType("application/json");request.responseType='text';request.withCredentials=false;request.setRequestHeader('api_key',FMPWPSdk.storeId);request.setRequestHeader('store-key',FMPWPSdk.storeId);request.setRequestHeader('secret-key',atob(FMPWPSdk.secretKey));request.setRequestHeader('Content-Type','application/json; charset=utf-8');request.setRequestHeader('Access-Control-Allow-Headers','Content-Type,x-requested-with,Authorization,Access-Control-Allow-Origin');request.setRequestHeader('Access-Control-Allow-Origin','*');request.setRequestHeader('Access-Control-Allow-Methods','GET, POST, PUT');request.setRequestHeader('Accept-Language','pt-BR,pt,en-US,en');if(data!==undefined&&data!==null&&typeof data!=='undefined'&&data!==''){request.send(JSON.stringify(data));}else{request.send();}},sendCdn:function(request,type,query,data){request.open(type,query,true);request.overrideMimeType("application/json");request.responseType='text';request.withCredentials=false;request.setRequestHeader('Content-Type','application/json; charset=utf-8');request.setRequestHeader('Access-Control-Allow-Headers','Content-Type,x-requested-with,Authorization,Access-Control-Allow-Origin');request.setRequestHeader('Access-Control-Allow-Origin','*');request.setRequestHeader('Access-Control-Allow-Methods','GET, POST, PUT');request.setRequestHeader('Accept-Language','pt-BR,pt,en-US,en');if(data!==undefined&&data!==null&&typeof data!=='undefined'&&data!==''){request.send(JSON.stringify(data));}else{request.send();}},getCdn:function(query){var request=this.XMLHttpRequest;this.sendCdn(request,'GET',query);return request;},get:function(query){var request=this.XMLHttpRequest;this.send(request,'GET',query);return request;},post:function(query,data){var request=this.XMLHttpRequest;this.send(request,'POST',query,data);return request;},put:function(query,data){var request=this.XMLHttpRequest;this.send(request,'PUT',query,data);return request;}}};(function(window,document){'use strict';FMPWPSdks.init(null,jQuery);})(window,document);